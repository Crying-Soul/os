#!/bin/bash

# Функция для определения типа процесса (системный или пользовательский)
check_process_type() {
    local flags=$1

    # Если флаг нечетный, процесс системный
    if (( (flags & 1) == 1 )); then
        return 0
    fi

    return 1
}

# Заголовок скрипта
echo "Анализ запущенных процессов..."
echo "==============================="

# Выводим заголовки таблицы с выравниванием
printf "%-10s %-15s %-20s %-15s\n" "PID" "Пользователь" "Команда" "Тип процесса"
echo "--------------------------------------------------------"

# Используем команду ps для получения информации о процессах, включая флаги
ps -eo pid,user,comm,flags | while read -r pid user comm flags; do
    # Пропускаем строку с заголовками
    if [[ "$pid" == "PID" ]]; then
        continue
    fi

    # Проверяем тип процесса
    if check_process_type "$flags"; then
        printf "%-10s %-15s %-20s %-15s\n" "$pid" "$user" "$comm" "Системный"
    else
        printf "%-10s %-15s %-20s %-15s\n" "$pid" "$user" "$comm" "Пользовательский"
    fi
done